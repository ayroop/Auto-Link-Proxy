# پلاگین Auto Proxy Links برای وردپرس

## توضیحات
این پلاگین وردپرس به طور خودکار لینک‌های مستقیم به `sv1.cinetory.space` را به لینک‌های پروکسی از طریق سرور ایران تبدیل می‌کند تا کاربران ایرانی بتوانند بدون محدودیت فایل‌ها را دانلود کنند.

## ویژگی‌ها
- ✅ تبدیل خودکار لینک‌های مستقیم به پروکسی
- ✅ پشتیبانی از دامنه و IP اختصاصی
- ✅ فیلتر کردن بر اساس دامنه و پسوند فایل
- ✅ شورت‌کد برای لینک‌های دستی
- ✅ تنظیمات پیشرفته در پنل مدیریت
- ✅ تست اتصال پروکسی
- ✅ حالت دیباگ برای توسعه
- ✅ رابط کاربری فارسی

## نصب و راه‌اندازی

### 1. نصب پلاگین
1. فایل‌های پلاگین را در پوشه `wp-content/plugins/auto-proxy-links/` کپی کنید
2. از پنل مدیریت وردپرس، پلاگین را فعال کنید
3. به بخش "تنظیمات > Auto Proxy Links" بروید

### 2. تنظیمات اولیه
در بخش تنظیمات عمومی:
- **دامنه پروکسی**: `sv5.filmkhabar.space`
- **IP اختصاصی**: `185.235.196.22`
- **استفاده از IP**: اختیاری (برای استفاده از IP به جای دامنه)

### 3. تست اتصال
از بخش "تست اتصال" برای اطمینان از عملکرد صحیح استفاده کنید.

## نحوه استفاده

### تبدیل خودکار
پس از فعال‌سازی پلاگین، تمام لینک‌های مستقیم به `sv1.cinetory.space` در محتوای سایت به طور خودکار تبدیل می‌شوند:

**لینک اصلی:**
```
https://sv1.cinetory.space/h2/movie/sv1/tt1780967/Seberg.2019.480p.HardSub.SerFil.mp4
```

**لینک پروکسی:**
```
https://sv5.filmkhabar.space/proxy.php?url=https%3A//sv1.cinetory.space/h2/movie/sv1/tt1780967/Seberg.2019.480p.HardSub.SerFil.mp4
```

### شورت‌کد دستی
برای لینک‌های دستی از شورت‌کد زیر استفاده کنید:

```
[proxy_link url="https://sv1.cinetory.space/h2/movie/file.mp4" text="دانلود فیلم"]
```

### استفاده در کد PHP
```php
// تبدیل URL به پروکسی
$proxy_url = AutoProxyLinks::convertUrl($original_url);

// تست اتصال
AutoProxyLinks::testConnection(function($success, $message) {
    if ($success) {
        echo "اتصال موفق: " . $message;
    } else {
        echo "خطا: " . $message;
    }
});
```

## تنظیمات پیشرفته

### دامنه‌های مجاز
فقط لینک‌های این دامنه‌ها تبدیل می‌شوند:
- `sv1.cinetory.space`
- می‌توانید دامنه‌های دیگر اضافه کنید

### پسوندهای مجاز
فقط فایل‌های با این پسوندها تبدیل می‌شوند:
- `mp4`, `avi`, `mkv`, `mov`, `wmv`, `flv`, `webm`, `m4v`, `ts`, `mts`, `m2ts`

### محتوای قابل پردازش
انتخاب کنید کدام بخش‌های سایت پردازش شوند:
- ✅ پست‌ها
- ✅ صفحات  
- ✅ ویجت‌ها
- ⚪ نظرات (اختیاری)

## ساختار فایل‌ها

```
wordpress-plugin/
├── auto-proxy-links.php          # فایل اصلی پلاگین
├── admin/
│   └── admin-page.php            # صفحه تنظیمات
├── assets/
│   └── js/
│       └── auto-proxy-links.js   # اسکریپت فرانت‌اند
└── README.md                     # این فایل
```

## API و هوک‌ها

### فیلترها
```php
// تغییر تنظیمات پلاگین
add_filter('auto_proxy_links_settings', function($settings) {
    $settings['allowed_hosts'][] = 'example.com';
    return $settings;
});

// تغییر URL پروکسی
add_filter('auto_proxy_links_proxy_url', function($proxy_url, $original_url) {
    return $proxy_url;
}, 10, 2);
```

### اکشن‌ها
```php
// قبل از تبدیل لینک
add_action('auto_proxy_links_before_convert', function($url) {
    // کد شما
});

// بعد از تبدیل لینک
add_action('auto_proxy_links_after_convert', function($original_url, $proxy_url) {
    // کد شما
}, 10, 2);
```

## عیب‌یابی

### حالت دیباگ
در تنظیمات پیشرفته، حالت دیباگ را فعال کنید تا لاگ تبدیل لینک‌ها ثبت شود.

### تست اتصال
از بخش "تست اتصال" برای بررسی عملکرد سرور پروکسی استفاده کنید.

### بررسی لاگ‌ها
لاگ‌های وردپرس را در `wp-content/debug.log` بررسی کنید.

## امنیت

### محدودیت‌های امنیتی
- فقط دامنه‌های مجاز پردازش می‌شوند
- فقط پسوندهای مجاز تبدیل می‌شوند
- بررسی صحت URL قبل از تبدیل

### توصیه‌های امنیتی
- از HTTPS برای سرور پروکسی استفاده کنید
- محدودیت‌های دسترسی مناسب تنظیم کنید
- به‌روزرسانی‌های امنیتی را نصب کنید

## پشتیبانی

### مشکلات رایج
1. **لینک‌ها تبدیل نمی‌شوند**: بررسی کنید که دامنه در لیست مجاز باشد
2. **خطای اتصال**: سرور پروکسی را بررسی کنید
3. **عملکرد کند**: حالت دیباگ را غیرفعال کنید

### تماس با پشتیبانی
- ایمیل: support@sv5.filmkhabar.space
- وب‌سایت: https://sv5.filmkhabar.space

## تغییرات نسخه

### نسخه 1.0.0
- ✅ تبدیل خودکار لینک‌ها
- ✅ پشتیبانی از دامنه و IP
- ✅ شورت‌کد دستی
- ✅ تنظیمات پیشرفته
- ✅ تست اتصال
- ✅ رابط کاربری فارسی

## مجوز
این پلاگین تحت مجوز MIT منتشر شده است.

## مشارکت
برای مشارکت در توسعه این پلاگین، لطفاً با ما تماس بگیرید. 